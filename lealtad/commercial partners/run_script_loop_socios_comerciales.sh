#!/bin/bash

# Start and End dates extracted from the monday_groups_2024_2025.csv
start_dates=(
  '20231204' '20231211' '20231218' '20231225' '20240101' '20240108' '20240115'
  '20240122' '20240129' '20240205' '20240212' '20240219' '20240226' '20240304'
  '20240311' '20240318' '20240325' '20240401' '20240408' '20240415' '20240422'
  '20240429' '20240506' '20240513' '20240520' '20240527' '20240603' '20240610'
  '20240617' '20240624' '20240701' '20240708' '20240715' '20240722' '20240729'
  '20240805' '20240812' '20240819' '20240826' '20240902' '20240909' '20240916'
  '20240923' '20240930' '20241007' '20241014' '20241021' '20241028' '20241104'
  '20241111' '20241118' '20241125' '20241202' '20241209'
)
end_dates=(
  '20231231' '20240107' '20240114' '20240121' '20240128' '20240204' '20240211'
  '20240218' '20240225' '20240303' '20240310' '20240317' '20240324' '20240331'
  '20240407' '20240414' '20240421' '20240428' '20240505' '20240512' '20240519'
  '20240526' '20240602' '20240609' '20240616' '20240623' '20240630' '20240707'
  '20240714' '20240721' '20240728' '20240804' '20240811' '20240818' '20240825'
  '20240901' '20240908' '20240915' '20240922' '20240929' '20241006' '20241013'
  '20241020' '20241027' '20241103' '20241110' '20241117' '20241124' '20241201'
  '20241208' '20241215' '20241222' '20241229' '20250105'
)

# Loop through the lists and run the script in parallel
for i in ${!start_dates[@]}; do
    start_date=${start_dates[$i]}
    end_date=${end_dates[$i]}

    # Run the Python script in the background
    python3 analysis_per_proveedor_promolealtad_v2.py --start_date $start_date --end_date $end_date &
done

# Wait for all background jobs to finish
wait
